<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Paul Northrop and Richard Chandler" />

<meta name="date" content="2023-08-25" />

<title>Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introducing chandwich: Chandler-Bate
Sandwich Loglikelihood Adjustment</h1>
<h4 class="author">Paul Northrop and Richard Chandler</h4>
<h4 class="date">2023-08-25</h4>


<div id="TOC">
<ul>
<li><a href="#loglikelihood-adjustment-using-the-adjust_loglik-function">Loglikelihood
adjustment using the adjust_loglik function</a></li>
<li><a href="#binomial-model">Binomial model</a>
<ul>
<li><a href="#confidence-intervals">Confidence intervals</a></li>
</ul></li>
<li><a href="#extreme-value-modelling-of-maximum-temperatures">Extreme
value modelling of maximum temperatures</a>
<ul>
<li><a href="#confidence-intervals-1">Confidence intervals</a></li>
<li><a href="#confidence-regions">Confidence regions</a></li>
<li><a href="#comparing-nested-models">Comparing nested models</a></li>
</ul></li>
<li><a href="#misspecified-poisson-model">Misspecified Poisson model</a>
<ul>
<li><a href="#confidence-intervals-2">Confidence intervals</a></li>
<li><a href="#confidence-regions-1">Confidence regions</a></li>
<li><a href="#comparing-nested-models-1">Comparing nested
models</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>The <em>chandwich</em> package performs adjustments of an
independence loglikelihood using a robust sandwich estimator of the
parameter covariance matrix, based on the methodology in <span class="citation">Chandler and Bate (2007)</span>. This can be used for
cluster correlated data when interest lies in the parameter vector <span class="math inline">\(\theta\)</span> of the marginal distributions or
for performing inferences that are robust to certain types of model
misspecification.</p>
<p>Suppose that we have <span class="math inline">\(k\)</span> clusters
of observations <span class="math inline">\(\{y_j, j = 1, \ldots,
k\}\)</span>, where <span class="math inline">\(y_j\)</span> is a vector
of observations for the <span class="math inline">\(j\)</span>th
cluster. The independence loglikelihood function is given by<br />
<span class="math display">\[\ell_I(\theta) = \sum_{j=1}^{k}
\ell_j(\theta; y_j),\]</span> where <span class="math inline">\(\ell_j(\theta; y_j)\)</span> is the contribution
from the <span class="math inline">\(j\)</span>th cluster. Suppose that
the independence maximum likelihood estimator (MLE) <span class="math inline">\(\hat{\theta}\)</span> is the unique root of <span class="math display">\[\frac{\partial \ell_I(\theta)}{\partial \theta} =
\sum_{j=1}^{k} \frac{\partial \ell_j(\theta; y_j)}{\partial \theta} =
\sum_{j=1}^{k} U_j(\theta) = 0.\]</span> The adjustments scale <span class="math inline">\(\ell_I(\theta)\)</span> about <span class="math inline">\(\hat{\theta}\)</span> so that the Hessian <span class="math inline">\(\hat{H}_A\)</span> of the adjusted loglikelihood
is consistent with the sandwich estimator <span class="citation">(Davison 2003)</span> of the covariance matrix of <span class="math inline">\(\hat{\theta}\)</span>. Specifically, <span class="math inline">\(\hat{H}_A^{-1} = -\hat{H}^{-1} \hat{V}
\hat{H}^{-1},\)</span> where <span class="math inline">\(\hat{H}\)</span> is the Hessian of <span class="math inline">\(l_I(\theta)\)</span> at <span class="math inline">\(\hat{\theta}\)</span> and <span class="math inline">\(\hat{V} =\sum_{j=1}^{k} U_j(\hat{\theta})
U^{T}_j(\hat{\theta})\)</span>.</p>
<p>There are two types of adjustment. A horizontal adjustment <span class="math display">\[\ell_A(\theta) = \ell_I(\hat{\theta} + C(\theta -
\hat{\theta}))\]</span> where the parameter scale is adjusted, and a
vertical adjustment <span class="math display">\[\ell_{A2}(\theta) =
\ell_I(\hat{\theta}) +
\{(\theta - \hat{\theta})^T \hat{H}_A (\theta - \hat{\theta})\}
\frac{\ell_I(\theta) - \ell_I(\hat{\theta})}{(\theta - \hat{\theta})^T
\hat{H}_I (\theta - \hat{\theta})},\]</span> where the loglikelihood is
scaled. The differences between these adjustments are discussed in
Section 6 of <span class="citation">Chandler and Bate (2007)</span>. The
horizontal adjustment involves calculating matrix square roots of <span class="math inline">\(\hat{H}\)</span> and <span class="math inline">\(\hat{H}_A\)</span>. <span class="citation">Chandler and Bate (2007)</span> consider two ways of
doing this, one using Cholesky decomposition another using spectral
decomposition.</p>
<div id="loglikelihood-adjustment-using-the-adjust_loglik-function" class="section level2">
<h2>Loglikelihood adjustment using the adjust_loglik function</h2>
<p>The function <code>adjust_loglik</code> returns an object of class
<code>chandwich</code>: a function that can be used to evaluate <span class="math inline">\(\ell_I(\theta)\)</span>, <span class="math inline">\(\ell_{A2}(\theta)\)</span> and both choices of
<span class="math inline">\(\ell_A(\theta)\)</span>. Functions that take
a <code>chandwich</code> object as an argument have a vector argument
<code>type</code>, equal to one of
<code>&quot;vertical&quot;, &quot;cholesky&quot;, &quot;spectral&quot;, &quot;none&quot;</code>, to select the
type of adjustment. The default is <code>type = &quot;vertical&quot;</code>.</p>
<p>We illustrate the loglikelihood adjustments and the use of the
functions in <em>chandwich</em> using some examples, starting with a
simple model that has one parameter.</p>
</div>
<div id="binomial-model" class="section level2">
<h2>Binomial model</h2>
<p>The <code>rats</code> data <span class="citation">(Tarone
1982)</span> contain information about an experiment in which, for each
of 71 groups of rats, the total number of rats in the group and the
numbers of rats who develop a tumor is recorded. We model these data
using a binomial distribution, treating each groups of rats as a
separate cluster. A Bayesian analysis of these data based on a
hierarchical binomial-beta model is presented in Section 5.3 of <span class="citation">Gelman et al. (2014)</span>.</p>
<p>The following code creates a function that returns a vector of the
loglikelihood contributions from individual groups of rats, calls
<code>adjust_loglik</code> to make the adjustments, produces a basic
summary of the MLE and the unadjusted and adjusted standard errors and
plots the adjusted and unadjusted loglikelihood. There is no need to
supply the argument <code>cluster</code> in this example because the
default, that each observation (group of rats) forms its own cluster
applies here.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chandwich)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>binom_loglik <span class="ot">&lt;-</span> <span class="cf">function</span>(prob, data) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (prob <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> prob <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="sc">-</span><span class="cn">Inf</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">dbinom</span>(data[, <span class="st">&quot;y&quot;</span>], data[, <span class="st">&quot;n&quot;</span>], prob, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the adjustments</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>rat_res <span class="ot">&lt;-</span> <span class="fu">adjust_loglik</span>(<span class="at">loglik =</span> binom_loglik, <span class="at">data =</span> rats, <span class="at">par_names =</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rat_res)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      MLE       SE adj. SE</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p 0.1535 0.008645 0.01305</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rat_res, <span class="at">type =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">legend_pos =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In the one-dimensional case the (horizontal) Cholesky and spectral
adjustments are identical and, over the range in the plot, the vertical
adjustment is very similar to the horizontal adjustments. Appreciable
differences only becomes apparent towards the edges of the parameter
space, where the behaviour of the vertical adjustment, which approaches
<span class="math inline">\(-\infty\)</span> as <span class="math inline">\(p\)</span> approaches 0 and 1, may be preferable
to the behaviour of the horizontal adjustments. As we expect in this
example the adjusted standard error is slightly greater than the
unadjusted standard error.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rat_res, <span class="at">type =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">legend_pos =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div id="confidence-intervals" class="section level3">
<h3>Confidence intervals</h3>
<p>The function <code>conf_intervals</code> calculates (profile, if
necessary) likelihood-based confidence intervals for individual
parameters, and also provides symmetric intervals based on a normal
approximation to the sampling distribution of the estimator.
<em>chandwich</em> also has a <code>confint</code> S3 method, which
produces only the likelihood-based intervals.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% confidence intervals, unadjusted and vertically adjusted</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conf_intervals</span>(rat_res, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: binom_loglik </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95% confidence interval, independence loglikelihood</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Symmetric:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    lower   upper </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p  0.1366  0.1705</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Likelihood-based:</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    lower   upper </span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p  0.1372  0.1710</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">conf_intervals</span>(rat_res)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: binom_loglik </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95% confidence interval, adjusted loglikelihod with type = &#39;&#39;vertical&#39;&#39; </span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Symmetric:</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    lower   upper </span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p  0.1280  0.1791</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Likelihood-based:</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    lower   upper </span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p  0.1292  0.1802</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(rat_res)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       2.5 %    97.5 %</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p 0.1292236 0.1802395</span></span></code></pre></div>
</div>
</div>
<div id="extreme-value-modelling-of-maximum-temperatures" class="section level2">
<h2>Extreme value modelling of maximum temperatures</h2>
<p>We consider the example presented in Section 5.2 of <span class="citation">Chandler and Bate (2007)</span>. The
<code>owtemps</code> data contain annual maximum temperatures in Oxford
and Worthing in the U.K. from 1901 to 1980, which are viewed as 80
clusters of independent observations from a bivariate distribution. We
construct an independence loglikelihood based on generalized extreme
value (GEV) models for the marginal distributions at Oxford and
Worthing. The model is parameterized so that the marginal distribution
at Oxford is GEV(<span class="math inline">\(\mu_0 + \mu_1, \sigma_0 +
\sigma_1, \xi_0 + \xi_1\)</span>) and at Worthing is GEV(<span class="math inline">\(\mu_0 - \mu_1, \sigma_0 - \sigma_1, \xi_0 -
\xi_1\)</span>), where GEV(<span class="math inline">\(\mu, \sigma,
\xi\)</span>) denotes a GEV distribution with location <span class="math inline">\(\mu\)</span>, scale <span class="math inline">\(\sigma\)</span> and shape <span class="math inline">\(\xi\)</span>.</p>
<p>We perform loglikelihood adjustment for the full six-parameter model
and reproduce the relevant rows of Table 2 in <span class="citation">Chandler and Bate (2007)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>gev_loglik <span class="ot">&lt;-</span> <span class="cf">function</span>(pars, data) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  o_pars <span class="ot">&lt;-</span> pars[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)] <span class="sc">+</span> pars[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  w_pars <span class="ot">&lt;-</span> pars[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)] <span class="sc">-</span> pars[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(o_pars[<span class="dv">2</span>] <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">|</span> w_pars[<span class="dv">2</span>] <span class="sc">&lt;=</span> <span class="dv">0</span>)) <span class="fu">return</span>(<span class="sc">-</span><span class="cn">Inf</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  o_data <span class="ot">&lt;-</span> data[, <span class="st">&quot;Oxford&quot;</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  w_data <span class="ot">&lt;-</span> data[, <span class="st">&quot;Worthing&quot;</span>]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  check <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> o_pars[<span class="dv">3</span>] <span class="sc">*</span> (o_data <span class="sc">-</span> o_pars[<span class="dv">1</span>]) <span class="sc">/</span> o_pars[<span class="dv">2</span>]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(<span class="fu">any</span>(check <span class="sc">&lt;=</span> <span class="dv">0</span>))) <span class="fu">return</span>(<span class="sc">-</span><span class="cn">Inf</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  check <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> w_pars[<span class="dv">3</span>] <span class="sc">*</span> (w_data <span class="sc">-</span> w_pars[<span class="dv">1</span>]) <span class="sc">/</span> w_pars[<span class="dv">2</span>]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(<span class="fu">any</span>(check <span class="sc">&lt;=</span> <span class="dv">0</span>))) <span class="fu">return</span>(<span class="sc">-</span><span class="cn">Inf</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  o_loglik <span class="ot">&lt;-</span> <span class="fu">log_gev</span>(o_data, o_pars[<span class="dv">1</span>], o_pars[<span class="dv">2</span>], o_pars[<span class="dv">3</span>])</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  w_loglik <span class="ot">&lt;-</span> <span class="fu">log_gev</span>(w_data, w_pars[<span class="dv">1</span>], w_pars[<span class="dv">2</span>], w_pars[<span class="dv">3</span>])</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(o_loglik <span class="sc">+</span> w_loglik)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial estimates (method of moments for the Gumbel case)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">var</span>(owtemps))) <span class="sc">/</span> pi)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">colMeans</span>(owtemps) <span class="sc">-</span> <span class="fl">0.57722</span> <span class="sc">*</span> sigma)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>init <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(mu), <span class="sc">-</span><span class="fu">diff</span>(mu) <span class="sc">/</span> <span class="dv">2</span>, <span class="fu">mean</span>(sigma), <span class="sc">-</span><span class="fu">diff</span>(sigma) <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the log-likelihood adjustment of the full model </span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>par_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mu[0]&quot;</span>, <span class="st">&quot;mu[1]&quot;</span>, <span class="st">&quot;sigma[0]&quot;</span>, <span class="st">&quot;sigma[1]&quot;</span>, <span class="st">&quot;xi[0]&quot;</span>, <span class="st">&quot;xi[1]&quot;</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>large <span class="ot">&lt;-</span> <span class="fu">adjust_loglik</span>(gev_loglik, <span class="at">data =</span> owtemps, <span class="at">init =</span> init,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">par_names =</span> par_names)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows 1, 3 and 4 of Table 2 of Chandler and Bate (2007)</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">attr</span>(large, <span class="st">&quot;MLE&quot;</span>), <span class="dv">4</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mu[0]    mu[1] sigma[0] sigma[1]    xi[0]    xi[1] </span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  81.1702   2.6684   3.7291   0.5312  -0.1989  -0.0883</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">attr</span>(large, <span class="st">&quot;SE&quot;</span>), <span class="dv">4</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mu[0]    mu[1] sigma[0] sigma[1]    xi[0]    xi[1] </span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.3282   0.3282   0.2293   0.2293   0.0494   0.0494</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">attr</span>(large, <span class="st">&quot;adjSE&quot;</span>), <span class="dv">4</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mu[0]    mu[1] sigma[0] sigma[1]    xi[0]    xi[1] </span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.4036   0.2128   0.2426   0.1911   0.0394   0.0362</span></span></code></pre></div>
<div id="confidence-intervals-1" class="section level3">
<h3>Confidence intervals</h3>
<p>We use <code>conf_intervals</code> to calculate profile
likelihood-based confidence intervals for the parameters.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% confidence intervals, vertically adjusted</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conf_intervals</span>(large)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: gev_loglik </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95% confidence intervals, adjusted loglikelihod with type = &#39;&#39;vertical&#39;&#39; </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Symmetric:</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           lower     upper   </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu[0]     80.37910  81.96121</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu[1]      2.25128   3.08552</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma[0]   3.25368   4.20459</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma[1]   0.15660   0.90574</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xi[0]     -0.27623  -0.12166</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xi[1]     -0.15939  -0.01731</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Profile likelihood-based:</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           lower     upper   </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu[0]     80.37291  81.96021</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu[1]      2.24357   3.08287</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma[0]   3.29922   4.25998</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma[1]   0.16118   0.94338</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xi[0]     -0.27410  -0.11572</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xi[1]     -0.16519  -0.02002</span></span></code></pre></div>
</div>
<div id="confidence-regions" class="section level3">
<h3>Confidence regions</h3>
<p>We reproduce Figure 4(b) of <span class="citation">Chandler and Bate
(2007)</span>, adding a 95% confidence region for the vertical
adjustment.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>which_pars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sigma[0]&quot;</span>, <span class="st">&quot;sigma[1]&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>gev_none <span class="ot">&lt;-</span> <span class="fu">conf_region</span>(large, <span class="at">which_pars =</span> which_pars, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>gev_vertical <span class="ot">&lt;-</span> <span class="fu">conf_region</span>(large, <span class="at">which_pars =</span> which_pars)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>gev_cholesky <span class="ot">&lt;-</span> <span class="fu">conf_region</span>(large, <span class="at">which_pars =</span> which_pars, <span class="at">type =</span> <span class="st">&quot;cholesky&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>gev_spectral <span class="ot">&lt;-</span> <span class="fu">conf_region</span>(large, <span class="at">which_pars =</span> which_pars, <span class="at">type =</span> <span class="st">&quot;spectral&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gev_none, gev_cholesky, gev_vertical, gev_spectral, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">3.0</span>, <span class="fl">4.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.25</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The 95% contours of the profile adjusted loglikelihoods are
similar.</p>
</div>
<div id="comparing-nested-models" class="section level3">
<h3>Comparing nested models</h3>
<p>Suppose that we wish to test the null hypothesis that Oxford and
Worthing share a common GEV shape parameter, that is, that <span class="math inline">\(\xi_1 = 0\)</span>. We call
<code>adjust_loglik</code> again using the argument
<code>fixed_pars</code> to fix <span class="math inline">\(\xi_1\)</span> to zero and perform loglikelihood
adjustment under the reduced model. Then we use
<code>compare_models</code> to carry out an adjusted likelihood ratio
test. If <code>approx = FALSE</code> (the default) then equation (17) in
Section 3.3 of <span class="citation">Chandler and Bate (2007)</span> is
used. If <code>approx = TRUE</code> then the approximation detailed in
equations (18)-(20) is used.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>medium <span class="ot">&lt;-</span> <span class="fu">adjust_loglik</span>(<span class="at">larger =</span> large, <span class="at">fixed_pars =</span> <span class="st">&quot;xi[1]&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(large, medium)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: gev_loglik </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H0: &quot;xi[1]&quot; = 0 </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HA: unrestricted model </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; test statistic = 6.356, df = 1, p-value = 0.0117</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(large, medium, <span class="at">approx =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: gev_loglik </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H0: &quot;xi[1]&quot; = 0 </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HA: unrestricted model </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using using approximation (18) of Chandler and Bate (2007): </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; test statistic = 5.245, df = 1, p-value = 0.022</span></span></code></pre></div>
<p>Alternatively, we can call <code>compare_models</code> directly
without first creating <code>medium</code>, using the argument
<code>fixed_pars</code> to fix <span class="math inline">\(\xi_1\)</span> to zero.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(large, <span class="at">fixed_pars =</span> <span class="st">&quot;xi[1]&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: gev_loglik </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H0: &quot;xi[1]&quot; = 0 </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HA: unrestricted model </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; test statistic = 6.356, df = 1, p-value = 0.0117</span></span></code></pre></div>
<p>In this case whether or not we use the approximate approach has a
non-negligible effect on the <span class="math inline">\(p\)</span>-value but we would probably reject the
null in either case.</p>
<p><em>chandwich</em> also has an <code>anova</code> S3 method to
compare nested models of class <code>&quot;chandwich&quot;</code>. We perform
loglikelihood adjustment of the models in which Oxford and Worthing
share common GEV scale and shape parameters (<code>small</code>) and
share all GEV parameters (<code>tiny</code>). Then we perform pairwise
comparisons of neighbouring nest models using <code>anova()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>small <span class="ot">&lt;-</span> <span class="fu">adjust_loglik</span>(<span class="at">larger =</span> large, <span class="at">fixed_pars =</span> <span class="fu">c</span>(<span class="st">&quot;sigma[1]&quot;</span>, <span class="st">&quot;xi[1]&quot;</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tiny <span class="ot">&lt;-</span> <span class="fu">adjust_loglik</span>(<span class="at">larger =</span> large, <span class="at">fixed_pars =</span> <span class="fu">c</span>(<span class="st">&quot;mu[1]&quot;</span>, <span class="st">&quot;sigma[1]&quot;</span>, <span class="st">&quot;xi[1]&quot;</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(large, medium, small, tiny)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of (Adjusted) Deviance Table</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Model.Df Df  ALRTS Pr(&gt;ALRTS)    </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; large         6                         </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; medium        5  1  6.356    0.01170 *  </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; small         4  1  4.251    0.03924 *  </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tiny          3  1 81.714    &lt; 2e-16 ***</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(large, medium, small, tiny, <span class="at">approx =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of (Adjusted) Deviance Table</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Model.Df Df   ALRTS Pr(&gt;ALRTS)    </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; large         6                          </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; medium        5  1   5.245    0.02200 *  </span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; small         4  1   4.184    0.04081 *  </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tiny          3  1 112.822    &lt; 2e-16 ***</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
</div>
<div id="misspecified-poisson-model" class="section level2">
<h2>Misspecified Poisson model</h2>
<p>We repeat part of an example from Section 5.1 of the <a href="https://CRAN.R-project.org/package=sandwich">Object-Oriented
Computation of Sandwich Estimators</a> vignette of the <em>sandwich</em>
package <span class="citation">(Zeileis 2006)</span>, using the same
simulated dataset. This example illustrates that sandwich estimators may
result in inferences that are robust against certain types model
misspecification. We simulate data from a log-linear negative binomial
regression model and fit a misspecified log-quadratic Poisson regression
model.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">250</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="dv">250</span>, <span class="at">mu =</span> <span class="fu">exp</span>(<span class="dv">1</span> <span class="sc">+</span> x), <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>fm_pois <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">family =</span> poisson)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">summary</span>(fm_pois)<span class="sc">$</span>coefficients, <span class="dv">3</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    1.063      0.041  25.709    0.000</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x              0.996      0.054  18.606    0.000</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(x^2)        -0.049      0.023  -2.122    0.034</span></span></code></pre></div>
<p>Although the conditional mean of <code>y</code> is linear in
<code>x</code> overdispersion of the responses relative to the Poisson
distribution contributes to the spurious significance of the quadratic
term. We adjust the independence log-likelihood, with each observation
forming its own cluster.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pois_glm_loglik <span class="ot">&lt;-</span> <span class="cf">function</span>(pars, y, x) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  log_mu <span class="ot">&lt;-</span> pars[<span class="dv">1</span>] <span class="sc">+</span> pars[<span class="dv">2</span>] <span class="sc">*</span> x <span class="sc">+</span> pars[<span class="dv">3</span>] <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">dpois</span>(y, <span class="at">lambda =</span> <span class="fu">exp</span>(log_mu), <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>pois_quad <span class="ot">&lt;-</span> <span class="fu">adjust_loglik</span>(pois_glm_loglik, <span class="at">y =</span> y, <span class="at">x =</span> x, <span class="at">par_names =</span> pars)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pois_quad)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            MLE      SE adj. SE</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha  1.06300 0.04136 0.08378</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta   0.99610 0.05354 0.10520</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gamma -0.04913 0.02315 0.03628</span></span></code></pre></div>
<p>The adjusted standard errors agree with those in the
<em>sandwich</em> vignette and are sufficiently larger than the
unadjusted standard errors to alleviate the spurious significance of the
quadratic term: the <span class="math inline">\(p\)</span>-value changes
from 0.034 to 0.18. For full details please see the <em>sandwich</em>
vignette.</p>
<div id="confidence-intervals-2" class="section level3">
<h3>Confidence intervals</h3>
<p>We use <code>conf_intervals</code> to calculate profile
likelihood-based confidence intervals for the parameters.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% confidence intervals, vertically adjusted</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conf_intervals</span>(pois_quad)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: pois_glm_loglik </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95% confidence intervals, adjusted loglikelihod with type = &#39;&#39;vertical&#39;&#39; </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Symmetric:</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        lower     upper   </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha   0.89907   1.22747</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta    0.78986   1.20231</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gamma  -0.12024   0.02199</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Profile likelihood-based:</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        lower    upper  </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha   0.8954   1.2232</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta    0.7877   1.1991</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gamma  -0.1198   0.0222</span></span></code></pre></div>
</div>
<div id="confidence-regions-1" class="section level3">
<h3>Confidence regions</h3>
<p>We call <code>adjust_loglik</code> again to fix the quadratic
coefficient at zero, producing a model with two free parameters, and use
<code>conf_region</code> to calculate the vertically adjusted and
unadjusted loglikelihoods over a grid for plotting. The plot below
illustrates the way in which the independence loglikelihood for <span class="math inline">\((\alpha, \beta)\)</span> has been scaled.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pois_lin <span class="ot">&lt;-</span> <span class="fu">adjust_loglik</span>(<span class="at">larger =</span> pois_quad, <span class="at">fixed_pars =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pois_vertical <span class="ot">&lt;-</span> <span class="fu">conf_region</span>(pois_lin)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>pois_none <span class="ot">&lt;-</span> <span class="fu">conf_region</span>(pois_lin, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pois_none, pois_vertical, <span class="at">conf =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">95</span>, <span class="dv">99</span>), <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAABa1BMVEUAAAAAACsAADoAAGYAIUwAOjoAOpAAZpAAZrYyAAAyIUwyLlw6AAA6ADo6AGY6Ojo6OmY6ZmY6ZpA6ZrY6kNtZAABZACtZO2tmAABmADpmAGZmOgBmOjpmOpBmZjpmZmZmZrZmkLZmkNtmtrZmtttmtv9+Eyt+OzyQOgCQOjqQOmaQZgCQZmaQkGaQkLaQtpCQttuQ29uQ2/+fIQCfU2u2ZgC2Zjq2ttu225C22/+2/7a2///bkDrbkGbbtmbbtpDbtrbb25Db29vb/7bb///fOyvfRzzfU0zfU1zfU2vfU4bfU5/fc7nfkdDkU2vkU5/kc4bkc7nkkZ/kkdDkrufqU2vqU4bqU5/qc7nqkWvqkZ/qrrnqrufqydDqyf/vc2vvc4bvc5/vkWvvrobv5P/0kWv0kYb0/9D0/+f0///6rob65Ln6////tmb/tpD/trb/yZ//25D/27b/5Ln//7b//9D//9v//+f///959DGEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAaBUlEQVR4nO2djZ/cxlnHxQXcg56TQq/lXGhdmh44QHg5singhZbgEpbUKRAXCgFDIAFsssUXXy7689HbavUyI82M5tH8Rvp9P59cvKvRzGj1vWdeVjeTpIQAk4SuACFDUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdB4FjQhxIhQgvrNDrJE4gEKSqChoAQaCkqgoaAEGgpKoBESdJskyWXxj1ceesjOBxQ0SmQE3Z5cpTcXp+kUQfcnV9dnl/23+2+ZpaCgUSIi6O2D8+LnnUfTBFW8e3MxJqguBQWNEhFBD45s7jyioGQSghE0Y3NqJeim7rkmycmbRRNf6Jb/uD7LD+Y/7/zF2esXSXKe//uyTJyc54nyd8sUjyZeAIFBqA9aaXlzkVgIujkte6/pJjtpn7QELbqj++SydDVLtM1zzsvJz7g+O88S5e+eXDGCLgqxUXxpye0Dc0Fv7mVu5iKWY6NNS9B9rfxloePhR5Ygj9bZ4eIfhzMmXwABAWwedJ+32qWM+5agNxeloaWgl2n9o+yqtlJS0AWBJGjWmXzljzPvtgpBs1hcdFD7glZPZVHQZSItqMUgqfZOFUGLFJuyh6mIoGmViIIujZkj6NBzqIWX2Tio6oNuK0HPKxnTWr+WoLWPFHSRADXxuXLZsP+8HMpXo/h8tj9r3ctAuc8j6Hlb0GrcX43eC0HP57gAMg9Aghazn1eb3LfjPGiubPJ65l7e1yxUzOdBm4IW86BZ8K07AxvOgy4IJEF7qL6Lly2RoIEt6F3Vt52SJRI0hL6LPw6GJjxut0lOLQodg4JGiUwE1X6B5JadFyholAg18bcPRoIfBSVGSPVB98nw+IaCEiOgB0mRl0g8QEEJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEATn6DVCiJp8TfKjSVF0nqNEd8lkoCgCLoboJ3ysIJI8TxKvoRe/cZhjZFZLoDMA4igQ372BC3/zrNcAKr6O7rWGiOzXACZBxBBLWit1tRcUqReY8R3iSQgsQt6+EP4XNDDGiO+SyQBiV3QXgQVKJEEJF5BG33Q4SVFJpdIAhKvoI1RfPXGYY0R3yWSgEQs6HEe9PDGVv9nzhQ0UuITNJ4SiQcoKIGGghJoKCiBhoISaCgogYaCEmiWIuj+Ur0H4vFNCholyOuDWpWo+ZqTgkbOQtYHpaBLJbr1QcuHmPbFbp3lN5333ixC9Z2/vDj82UdedrUxLQWNHJT1QZMBWglL9fONvutNZO88Kjwsv47P3s0frT9sTEtBIwdkkDTkZyfptthy5ry9iexB0MMmSfXGtBQ0ckAEtaB40u7kqreJ7HEbz4r9YW/PqSWSgMQnaN56Zy18bxPZUtDDxjWHjWkpaORIC2qxmawp+1f+tAyi5UtlBK33oZMW1LRjQhyZOYL6uH83F/cPOx+WLy/7fdB6Y1oBQQf7y7TVMxE28dUGX51NZM+Po/hsoF9vTOtHUAf1aKsfYhS0msJqbiKb7yDbmgc9bEw7WVAvgtFUZ2IUdKYSpVSiqDZQUGXaWeyhqQYs5GERAwxLDKALBR1gIQ+LGGBQYmBTKKmC6B4WcWasRIAoxkjaB+VhEXkGS8QRg5K24SAJyc4KdkqPrF5QVBMoacnKBQVXgJKuWtA47v3KJV2toFHd9RU7uk5BY7zfK5U0mKDz0yna7/X0L1AizxVKup4IeihY7g4b/HJ4LMRfltCsTVDft3ZKKJ9cqIf6w7MuQT3eVSvzBERdi6SrEtTPDZ1qmTdRV6HomgT1cDMlGmoPtk+uCy7rEnTa2UKt6kRJF67omgR1R0xOTTFO54lUKTjrEPSdKSfPOxxxk3S5iq5B0H3yWjLy/LSeELfeKWAv1NE1CPp2/qfy5y5nBrzpDpIuUtE1CLo9T2++vRl+wl9F+BtuLWn4Kvtm+YK+k4XP5OTq+jt2p8HcaktHYertiaULWvc/91ZtPNhtXrGjSxe06n9ubEZJkDfYylHIK3Bj6YLa9z9xb669o7L1mYWlC2rZ/8S1s8TGUfRrMWPpghaY9j+juKUWjkZxPSOsQFDj/mc0d9PWUen6SLJsQe3uTUx30nyGNHJFhQTNun4F2jXEEAWNjHUoKiPoNql6fftE0/2b5QMzvi0/eCRaD0EWr6iIoI1vvrd31PceStCxlc6gMVd0hsr4R0TQxtau+4AL2JrekutXRxYzBWfRii45ghrekNsHp3mXWVNR/whcupGicbbzUn3QKoSG7IOa343N/fPiOye/pY/juzgvicAQGsUfVqnXhiUcQfdJ8nreJbF7mmSkZDs8FmqSyEtxc7HceVBTP0+z36Z8Jv/tK0/FGlvn29RFKrp6QbdZ8PzZt37hzMNA3lU0j5KaKjqpkFmRFlRgM1kzjKeYsl7I5nJy+PQimI9MlqbozBHUc79rsCTDhNt868RJHVCv1zT9EzI4OaJ2fqlNvOXn7xxBZX7hJlpqqKhT3nNDQYspB7cOqGhrMEnS5Si6ckGnr4Yz5XyzEtxKGT8tjnaegnrm+W73xG+Oro4uI4gKfRd/bJ8CjeKFBb19oOkUvPy7T9P/+ti3pStWVCaCht9MVlbQm3vtQdWuIk1fPM6C6IeFpc0jTqW0cHLUrJ13r9QMiD2wHHgzWVFBs/h5+6B8ymDXIougP372+U/+Obf0qerwFJwVnZoiKFJ90NCbyZr+xY5b7jff+NZVujlXqffy/ff+6cPc0qeN9L48dXE08sHSugdJbjfm5uJyf+fR7q9+SWHbiyfpFx89yy192juv8jOZ4qjDiCnuIEpBrbm59+Z5btsPv6zw7POfZOOj0lJFaQrsy1+XohTUlmyAdP3V9N2vDfwxc2FpuxwzTOtg62jEgyUKasv/PUxvf/ut8VZ6Vxag969s7x0ldVF0aoogrFpQ5zuyVbXuB3YK80YS7w71sZHU0tFIgygFdeHdryuneY8D9Vq1nQLNWYc6mVtqb+ioosa5zQUFdcg2GyCpOqC1aT0V7By1kdR7EDXObCYoqH22mmmiw9tjZmks7b5pKKnfriieoQsVVDiAqo41/RzLRxNLe28ZSbpsQxcqqJChA4I2OpGGmSkl7b8zrqh1EJ1weHYoqH2uKkHt/azP6zqpCK0jii7ZUApqn6tC0OYg3DJPlaSyikZlKAW1z7UvaHMAbpllI4uWk8qmfqhm/kbzUIZSUPtMVQPw8Rxfvr8be4x5pKn3p2hEhi5VUCP5HAXth1DDBv7zf3z2PFOu/5zTMZ/BMDrcznts5oEMpaAuefZD6FCGB8e++PePDw/a6xl21J+iPicGJKGgLnlqBFXl1xDsxeMshv7n48bbyin/4VH9oKILNJSCOuXZEUsraNOtPIC+/Nt/efHes7Q5cld52n279dKXonEM5hcrqIl9lregkbyj1G6nzq6l3ssPyv9/ovljkP6p/Zmn8S+r7AzF74hSULccFSFUcUNbqZ4/Kf9TdUM17b2qP1pVxYeiMRhKQR1z7IdQRW495fJn7TWPkqod1Sk61M57a+YRDKWgjjn2Gnn1CEnxlr7zqW/rFS/9KApvKAV1zbDjlvJeagc/Wk1VjqqSlBVagaHLFXR+Q/tnqAJkN0XPU0VsVQ2YyhoN9UQHL8YwIQWVQ17QlkPKLmjXMk3O3VCqbf5br9IRQ3VHegmRDV2woDMbmiSqDqf+lYKWhOqmvvvCj6GDB8MaSkEnZNgyKP8Dud4ZnRA6WoK9oh4aeWhDhQQ97HasXaBplov2bWgv8aihnQG4SSG9pr53sP1i4d1QGUGv716VG3xsdMswRinosKGJatEle0FtFV14N1RE0Gqvzk32c6NZIGaeax7/aCcK2jQ0OzhsqKmgaUtD9ZC+8ULc0KCNvIig1W7H+UayIXc7nqGN7z6s3De0LZN5URZRdHA61LA4WENFI+hpwI28qmLEQ+hx4FIc82doS8NhRRPVDEJVp9gHSjJ90O3JVdkRLbfBnJqdOzOEUDlD0wFD228oZxCqI54MNczFO5aC3n7vUfrnZ0ny1ZHN1ffZB3My4OdcgvoOoerE9fc61Yv+t0WKfxphqqhygDZQY2VCSEPtBN2fJSe//5U/eOf7vzZ172ocQT0ZepyS9G5ooyuqO5aUy5SZ11iZELEbaiXo7YPvpp99Mw+e16+O7OLhrdypzBJC0/aMpMrQne7YGGOKHuqli6GRd0OtBL35xsPiv7T6aUDgQZLJB2v10WsT75oP3CnH3f1/GjJgaNowVOe+H0FDNfJ2gubbA72Tv3LdHTipcTvfqcjpKVqJ9YZmftz+Xv1CF+z6x0YZ7okeKqZzP2pD7fqg25P7Ja/dv/8b3xsZKPkpdzrzNPKlO5skOW+87B7WHBrHwNBqGlaR8YoETb//66/VjG0m56fc6Xhu5Adu1Ltf+/nd7RuHTeiGht3Wig6Ms6q86jkEmxpbJQxiqMw8aP2wiFbiOa91rkb+z652P/y5t26+WbcsI0HUdk5U8c9Gtto5BAraZ3to6PaJprM667XOY+jtG99N0z/61fbjIfqZIVtFh+aqRgw1vzo8QyW/6szJv4+fmt1kTASd3sjnQ8ibe7/1i0ny5eObqiDqqGj7UdDusaFZrphDqIig1cMiOWEfFqlLm8XQ67MkyXrmu7/+zbda0U4xKap7UmmIwSf3urNcJvVVsBJB0SKoiX5+uqH7/HJvvv7Wbudf0c4zd72jjTp1s4y4jZfqg1YhFKMPKvGNp6YbelX9enYN1Stq7Gj3odDu4eYjTc6GrkTQrJEvR/Ga+Dm7oAKNvDL12/kDMuXv5ERF8zVIHnfO0L+q6tTKXndoGDRDhQSdO7vx8mZ4MjQtfjFPlPOgOkXbjjbeepEvxpxZ+riRvnN6v0rtCYTR2qqgoCLZGRTouZE3SW2maKs3Wr9RLDGW/TishaeYserXaLc8Q1cj6FyNfItdX9EhRxvkLfx7//3TT8tIqko1JmjbUAoqVa6/Emc19HBsXNE6dPbyeP73H6RHQbtHlV8YaUf6FFSqXI9FChiqTX481pHP0NEXWd/z+YeZoM81Wy6oB0nagZTFhWEZuiJB5ze0qWhnSK+KiM23P/+Hj1/86H8/UC93Wybvl9h9u1EKBZUq12uhvg0dTK5XVDf12QykX/zb4+y/py8e91JVKdVV0YVQCipVrt9STYbytoYaKWrW1DfH8sXLT5R+Kk89PG7XSdk6agQFFcjOuNh5DVUoOhpGFXOiisOKkqqDnbSto0ZQUIHsjIv1b+hI+iFFh77l3A2hrwQFnbtczwgZOqbo8ZVSUe038YZ6Nqe1uhm0DptAQQWysyh4fkNVipo7aliDOrP2Ae+Czm3o6gQVMdQkiPYU7TvqLqkugFJQ8XL9E8LQrqL93uckR7UBtHrDcnZ3ymHfrFBQGUNHz+itBtAX0tXRRBtAKah4uRKIGeqk6HRH9QGUgoqXK0IgQ/uKqiaarB0d8JOCipcrg4yhhop23tI7auZpcvgOSZW6eMvrg64UdBaCGZoqlqZS2aif+vxkt3uaPt/t/ubjQ3Z6mys/KahcuVIYGioURHuW6hzrz9G/eJx+8dH/fPTsmJk+1hbv2s/qTjnsm9UKamSfq6FGGfdDqda0lqBPsiD6rz/9jx99WmYw0A+Q8JOCzoaRfQ6GGms9EEkHznr542cv31cL3sXFTwoqkp0bUoZaRF6FaWOOmsmZOvpJQUWyc0SqI2rWzrcSt87QjnrqlE/yp5mHs81P9+8nBZ0VMUPtFE2blibHvmVT0uaRp/kffT4ZzG9XdUDt6z3tuG+EBN0kyWmxRqhuN1kQQc1CjJOhqvkkozMGMcqnNtsp9k877hsZQfMlwzbJaVqvAzMtO0lMDZ1H0e65QyFVTTOVQ+FoLbzg6nb7Yg0YjNXthjByyFm0CYo22FlSl+1Q36kJPCMiaLE+aLkyKMb6oIOYKRRY0QZGcqbO8w9TE3iGETSVbebTaS29OzJ+LkPQYx+0sZTthOzEMbuZUSnq2muensIvax/FV5gb6lrxWR11LQvPz7XPg9YY3tApks2lqM2EVO/U6Sk8Q0ErTO/pJMlmcHTa1Nb0FL6RFjT4ZrLG2Bg6VVGp+zwtb4NTlydoNxe7r0TmZZYgKvcZTM0U0k828U2M7+9ku7xLOj03s+8rJhTgBgVtMU8738zEi6QesgH1U0pQqM1kbbAKoh4uwkMo9SK5UQ7LERRsM1kr5mvnmxm5WuYpBsP6uZKtEK0wv+M+BzpJFw8pbQo3SjW9JGvkHhYpieBhkT5zt/Ot7CzxVK5RKh9l2cIIqiSUop2M5ZzsFGWWzHfBRqV6T5gDt5msNeYiyEgzI9B+So3i4TaTtWctipq3FcIV0RTrPWGQ7CSwsS5eRcH9pKBDWCsaxVU1selrC1dFV7D3hEGyE8LKuQgVtenGyNZEX7D3hEGyE8POucgUNa9suKuioCNYKheRohY1DXhNFHQUF0UjuLw4/KSgBtgaF4OiluM/yaqMFO49YZDshLE2Dt3RaPykoIY4KgoqqeXkhGBNxov3njBIdjNgrxuqo7aTZ4JVMSjfe8Ig2c2Ci26AjkblJwW1wsk2KEctqxK+3hTUEifZUBp721ogVNl7wiDZzYmbauEdtS8fwE8K6oKraQEddSkawU8K6oazaEmISOpUJEKXJKWgzrhrliSzWupYFIifFNSdSY4l82jqXAKInhR0GhP9ErbUPWeU8JlS0Kl4sEvG0ik5AvlJQSfjR62khaeM3LOYUAHPUFAP+Ap/SY85TlXk5HquABTUC35b6L5tFngo28tFeIKC+sKvo8085/CyUaKnnDxBQf0hoei8ANZfRNCbC+2KIi7ZRUTcjiLWXUjQXz7TrMnkkl1UxKsoZr2FBD1Pt/lGc36yiw2/vcKZQK2ymKD5ynYDjiJ+Fv7wPXQRB7eygoKmhaMxLmDrhXgcha6nrKB+souXGCQFryEFFQbbUeS6lXAedAZQJcWsVRsKOg94jqLVR4O0oPFsJisPkqQ4NRlh5gjq/bvjyMC4/vA1MIdN/Oz4f8LDpfwgRTtAQcOQBNEUIXxbIiRotJvJzsqcloaO267ICBrzZrKzI65OrG4WiAga/1aIs9MMph4/m6jdLBD6JinuzWRDkXTwlZev+oWAERSPrqemiinOi/9jluqDxr6ZLAIq4cwJXXtPCI3iF7CZLBLrcrIF50EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNEKCbl55mF6fJcnJlZfsyGqREbTw8+5Va527CdmR9SK0/OJ5JmmxUSdXtyOTEFsftFqCkeuDkkkINfFZ9NwygpLpyAh6c/HKwyKE7nWjJApKjJCaZtqXK1ZqN4ynoMQIzoMSaCgogUZaUG4mSyYxcwRd9nrqxD9s4gk0FJRAIyQoN5MlfpDayIubyRIviAjKrRCJL8QeFqngwyJkEoygBBqpPig3kyVeEBrFczNZ4gfOgxJoKCiBhoISaCgogYaCEmgoKIEmmKCEGBFIUHGg6svK6PBXGajLMgCqvqyMDgoKASujg4JCwMrooKAQsDI6KCgErIwOCgoBK6ODgkLAyuigoBCwMjrWKyhZGRSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNJEIuk+S4/ag2yRJNPvVz8T1q/X6va2aBeFYmWILAc3CmLNXJmejXQbRmDgEzTevrTew3eYvghqab6pb/bNVs8CVuX2QVWSr30h11srk7PXrdBoThaDl0s6b0+rF6fFFEPbHbU5aNQtdmeuz/LdWtwngzJVJi9VkVyJo65MPLug+Od/DONGsTPVOuHjeqcz2zu+sRdC7+Wd+uPbwTfxxD4l2zQJXpmSDUpnss1lLH7QMCnVoCD8uqW9Dp2ZhK1O+CjtKOlYm7/2sU9A8RFyfYdwGOEH3QcdIzcrkG8GsRdBWQxq825cCN/GB42f3k1mNoE0noYIW1G9LY6/KYNSV2VbLLE4dK0QhaGsyp3QCJGiFn2ZqtaqBv79Iu/dlLRG0PR2O1AcFmKhvhvPQ8XO1guYNRm5BNQca/Au94jaUldliTCnklala1fCdn/KTSdckKFkrFJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FFSU27eTk8tiPwHiBgUVJVPzszf+8EH4lY+jhYJKcnNxmf24fzfsEsxRQ0ElKXep8bAQ9nqhoJIUm1PXK7YTByioJDf3rjA234gXCirK5kuPPnvwpd/9k8++HbomsUJBRbl9O0l+5dHPzgLvVBMxFJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0FJRAQ0EJNBSUQENBCTQUlEBDQQk0/w+zxLGTm2LMLQAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-nested-models-1" class="section level3">
<h3>Comparing nested models</h3>
<p>We could examine the significance of the quadratic term using an
adjusted likelihood ratio test.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(pois_quad, pois_lin)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: pois_glm_loglik </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H0: &quot;gamma&quot; = 0 </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HA: unrestricted model </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; test statistic = 1.82, df = 1, p-value = 0.1773</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(pois_quad, pois_lin, <span class="at">approx =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: pois_glm_loglik </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H0: &quot;gamma&quot; = 0 </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HA: unrestricted model </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using using approximation (18) of Chandler and Bate (2007): </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; test statistic = 1.921, df = 1, p-value = 0.1658</span></span></code></pre></div>
<p>The <span class="math inline">\(p\)</span>-value based on equation
(17) of <span class="citation">Chandler and Bate (2007)</span> agrees
with the value in the <em>sandwich</em> vignette, which is based on a
Wald test, and the <span class="math inline">\(p\)</span>-value based on
equations (18)-(20) is only slightly different.</p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-CB2007" class="csl-entry">
Chandler, R. E., and S. Bate. 2007. <span>Inference for Clustered Data
Using the Independence Loglikelihood.</span> <em>Biometrika</em> 94
(1): 167183. doi:<a href="https://doi.org/10.1093/biomet/asm015">10.1093/biomet/asm015</a>.
</div>
<div id="ref-Davison2003" class="csl-entry">
Davison, A. C. 2003. <em>Statistical Models</em>. Cambridge Series in
Statistical and Probabilistic Mathematics. Cambridge University Press.
doi:<a href="https://doi.org/10.1017/CBO9780511815850">10.1017/CBO9780511815850</a>.
</div>
<div id="ref-BDA2014" class="csl-entry">
Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D.
B. Rubin. 2014. <em>Bayesian Data Analysis</em>. third. Florida, USA:
Chapman &amp; Hall / CRC.
</div>
<div id="ref-Tarone1982" class="csl-entry">
Tarone, Robert E. 1982. <span>The Use of Historical Control Information
in Testing for a Trend in Proportions.</span> <em>Biometrics</em> 38
(1). [Wiley, International Biometric Society]: 215220.
</div>
<div id="ref-sandwich" class="csl-entry">
Zeileis, Achim. 2006. <span>Object-Oriented Computation of Sandwich
Estimators.</span> <em>Journal of Statistical Software</em> 16 (9):
116. doi:<a href="https://doi.org/10.18637/jss.v016.i09">10.18637/jss.v016.i09</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
